<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ifactor.ir</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <header>
        <h1>سامانه اعتبارسنجی مجلات علمی</h1>
    </header>
    <main>
        <section class="search-section">
            <h2>جستجوی مجله</h2>
            <form id="search-form" action="/search" method="POST">
                <label for="search-input">عنوان مجله یا ISSN:</label>
                <input type="text" id="search-input" name="query" required placeholder="عنوان یا ISSN را وارد کنید...">
                <button type="submit">جستجو</button>
            </form>
        </section>

        <% if (journals && journals.length > 0) { %>
        <section id="results-section">
            <h2>نتایج جستجو</h2>
            <ul>
                <% journals.forEach(journal => { %>
                    <li>
                        <strong>عنوان:</strong> <%= journal.title %><br>
                        <strong>ISSN:</strong> <%= journal.issn %><br>
                        <h3>وضعیت در لیست‌ها:</h3>
                        <ul>
                            <% 
                                let relatedLists = lists ? lists.filter(list => list.journalId === journal.id) : [];
                                if (relatedLists.length > 0) { 
                            %>
                                <% relatedLists.forEach(list => { %>
                                    <li><%= list.name %> (<%= list.type %>)</li>
                                <% }) %>
                            <% } else { %>
                                <li>هیچ لیستی برای این مجله وجود ندارد.</li>
                            <% } %>
                        </ul>
                    </li>
                <% }) %>
            </ul>
        </section>
        <% } else if (typeof error === 'undefined' && typeof journals !== 'undefined') { %>
            <p>هیچ نتیجه‌ای یافت نشد.</p>
        <% } %>

        <% if (typeof error !== 'undefined' && error) { %>
            <section id="error-section">
                <p style="color: red;"><%= error %></p>
            </section>
        <% } %>          
    </main>
    <footer>
        <p>&copy; 2025 ifactor.ir</p>
    </footer>

    <script src="script.js"></script>
</body>
</html>
